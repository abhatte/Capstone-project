# Statistical Analysis Report

Ashwini Bhatte

******

The following variables will be investigated for statistical analysis

* Code vs Blood Glucose concentration

* Time vs Blood Glucose concentration

*****

```{r, include=FALSE}
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)

df <- data.frame()
for(i in 1:70) {
  num = paste("", i, sep = "")
  if (i < 10) num = paste("0", i, sep = "")
  fname = paste("~/R Projects/diabetes-dataset/Diabetes-Data/data-", num, sep = "")
  temp <- read_delim(fname, col_names = c("date", "time", "code", "bg_conc"), 
   col_types = cols(
    date = col_date(format = "%m-%d-%Y"),
    time = col_time(format = "%R"),
    code = col_integer(),
    bg_conc = col_character()
  ), "\t",
    escape_double = FALSE, trim_ws = TRUE);
  temp <- mutate(temp, patient_num = i)
  df <- rbind(df, temp);
}
summary(df)
# create clean_df = remove "000" & "3A" from bg_conc
clean_df <- subset(df, bg_conc != "000" & bg_conc != "3A")
# update clean_df = remove discrepancies in code "4", "36, & "56"
clean_df <- subset(clean_df, code != "4" & code != "36" & code != "56")
#convert clean_df$bg_conc from character to numeric
clean_df$bg_conc <- as.numeric(clean_df$bg_conc)
#remove NAs from above
clean_df <- na.omit(clean_df)
```


**_Code vs Blood Glucose concentration_**

```{r, echo=FALSE}
ggplot(clean_df, aes(factor(code), bg_conc)) +
  geom_boxplot() +
  labs(x = "Code", y = "BG concentration (mg/dl)")
```

```{r, echo=FALSE}
summary(clean_df$bg_conc)
```


Note that, there are 3 clear groups of codes.

To gain a better perspective at this, let’s plot the graph of BG concentration vs code by grouping the codes into 3 sub categories.

**1. group 1: code 33 - 35**

This group represent the codes for type of insulin dose

```{r, echo=FALSE}
c1 <- c(33:35)
clean_df1 <- clean_df[clean_df$code %in% c1,]
ggplot(clean_df1, aes(factor(code), bg_conc)) +
  geom_boxplot() +
  labs(x = "Code", y = "BG concentration (mg/dl)")
```


```{r, echo=FALSE}
summary(clean_df1$bg_conc)
```


From the above box plot, we can see that the BG concentation of a patient drops down after taking an exogenous insuline dose.

*****

**2. group 2: code 48, 57 - 64**

This group represent the codes which are related to meal (pre or post) of a patient.

```{r, echo=FALSE}
c2 <- c(48, 57:64)
clean_df2 <- clean_df[clean_df$code %in% c2,]
ggplot(clean_df2, aes(factor(code), bg_conc)) +
  geom_boxplot() +
  labs(x = "Code", y = "BG concentration (mg/dl)")
```

```{r, echo=FALSE}
summary(clean_df2$bg_conc)
```

Here the type of insuline injected will determine the level of BG concentration across various patients.

Note that, in the box plot above, codes 58, 60, 62, 64 represent a pre meal BG concentration and codes 59, 61, 63 represent a post meal BG concentration.

*****

**3. group 3: code 65 - 72**

```{r, echo=FALSE}
c3 <- c(65:72)
clean_df3 <- clean_df[clean_df$code %in% c3,]
ggplot(clean_df3, aes(factor(code), bg_conc)) +
  geom_boxplot() +
  labs(x = "Code", y = "BG concentration (mg/dl)")
```


```{r, echo=FALSE}
summary(clean_df3$bg_conc)
```

Since all the BG concentration measurements are 0, it's assumed that the values for codes were supposed to be measured but they are just the place holder for now.

*****

**Time vs Blood Glucose concentration**

Since time is a continuous variable, it will be difficult to export the data when time is plotted on x- axis. Which is why the time intervals of 2 hours (time_grp) were created. The distribution of BG measurements across various time intervals was explored initially using a simple bar plot.


```{r, include=FALSE}
clean_df <- clean_df %>%
  mutate(time_grp = gsub("^00:[0-9][0-9]:00|^01:[0-9][0-9]:00", "00-02", x = time))%>%
  mutate(time_grp = gsub("^02:[0-9][0-9]:00|^03:[0-9][0-9]:00", "02-04", x = time_grp))%>%
  mutate(time_grp = gsub("^04:[0-9][0-9]:00|^05:[0-9][0-9]:00", "04-06", x = time_grp))%>%   
  mutate(time_grp = gsub("^06:[0-9][0-9]:00|^07:[0-9][0-9]:00", "06-08", x = time_grp))%>%
  mutate(time_grp = gsub("^08:[0-9][0-9]:00|^09:[0-9][0-9]:00", "08-10", x = time_grp))%>%
  mutate(time_grp = gsub("^10:[0-9][0-9]:00|^11:[0-9][0-9]:00", "10-12", x = time_grp))%>%
  mutate(time_grp = gsub("^12:[0-9][0-9]:00|^13:[0-9][0-9]:00", "12-14", x = time_grp))%>%
  mutate(time_grp = gsub("^14:[0-9][0-9]:00|^15:[0-9][0-9]:00", "14-16", x = time_grp))%>%    
  mutate(time_grp = gsub("^16:[0-9][0-9]:00|^17:[0-9][0-9]:00", "16-18", x = time_grp))%>%
  mutate(time_grp = gsub("^18:[0-9][0-9]:00|^19:[0-9][0-9]:00", "18-20", x = time_grp))%>%
  mutate(time_grp = gsub("^20:[0-9][0-9]:00|^21:[0-9][0-9]:00", "20-22", x = time_grp))%>%
  mutate(time_grp = gsub("^22:[0-9][0-9]:00|^23:[0-9][0-9]:00", "22-24", x = time_grp))
```

```{r, include=FALSE}
clean_df <- clean_df %>%
  mutate(bg_symp = gsub("^([0-9]|[0-7][0-9]|80|1.5$|2.5$|3.5$|4.5$|6.5$|7.5$)$", 
                        "Hypoglycemia", x = bg_conc))%>%
  mutate(bg_symp = gsub("^(8[1-9]|9[0-9]|1[0-9][0-9])$", "Average", x = bg_symp))%>%
  mutate(bg_symp = gsub("^(2[0-9][0-9]|3[0-9][0-9]|4[0-9][0-9]|50[0-1])$", 
                        "Hyperglycemia", x = bg_symp))
```


```{r, echo=FALSE}
ggplot(clean_df, aes(time_grp)) +
 geom_bar() +
 labs(x = "Hours")
```


From the graph, we can say that most of the BG concentration was measured from 6 - 10, 12 - 14 & from 16 -24.

*****

Now let’s get a clearer view of the relationship between time interval and BG concentration by plotting a box plot.

```{r, echo=FALSE}
ggplot(clean_df, aes(factor(time_grp), bg_conc)) +
  geom_boxplot() +
  labs(x = "Hours", y = "Blood glucose concentration")
```

Note that the BG concentration remains lower from 4 - 10 am assuming that these are pre breakfast measurements. Similarly, the hypoglycaemia is observed from 16 - 22 assuming they are pre meal measurements.

However, BG concentration rises after a meal i.e from time slot 10 - 16 & 22 - 24.

***
  